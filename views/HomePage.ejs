<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
    />
    <link rel="stylesheet" href="../css/homePageStyles.css" />
    <title>Document</title>
  </head>
  <body>
    <nav class="navBar">
      <% if (!isAuthenticated){ %>
      <button class="signupBtn"><a href="/signup">SIGN UP</a></button>
      <button class="loginBtn"><a href="/login">LOGIN IN</a></button>
      <% } else{ %>
      <div class="profileCont">
        <div class="profileIconCont">
          <h2 class="userIcon"><%=currentUser.username[0].toUpperCase()%></h2>
        </div>
        <h2 class="userName"><%=currentUser.username%></h2>
      </div>
      <form class="logoutBtnCont" action="/logout" method="POST">
        <button type="submit" class="logoutBtn">LOGOUT</button>
      </form>
      <% } %>
    </nav>

    <div class="msgCont">
      <!-- Todo -->
      <!-- add  message and a join now button -->
      <% if(isAuthenticated===true && !currentUser.membershipstatus){%>

      <form class="joinNowCont" action="/join" method="GET">
        <h1 class="joinHead">Want to join the club?</h1>

        <button type="submit" class="joinBtn">JOIN NOW</button>
      </form>

      <%}%> <% for(let user of userMessageDetails){ %>

      <div class="msgCard">
        <% if(isAuthenticated && currentUser.membershipstatus){%>

        <div class="loggedInUserCont">
          <div class="loggedInUserIcon">
            <p class="loggedInUserNameIcon">
              <%=user.username[0].toUpperCase()%>
            </p>
          </div>
          <h3 class="loggedInUserName"><%=user.username%></h3>
        </div>

        <p class="anonymousUserMsg"><%=user.content%></p>

        <!-- prettier-ignore -->
        <%
          const date = new Date(user.createdate);
          const options = {
            weekday: 'short',
            day: 'numeric',
            month: 'short',
            hour: '2-digit',
            minute: '2-digit',
            hour12: true
          };
          const formattedDate = date.toLocaleString('en-GB', options);

        %>
        <p class="postedDateTime"><%=formattedDate%></p>
        <%}else{%>

        <div class="anonymousUserCont">
          <i class="fa-solid fa-circle-user anonymousUserImg"></i>
          <h3 class="anonymousUserName">Anonymous user</h3>
        </div>

        <p class="anonymousUserMsg"><%=user.content%></p>

        <%}%>
      </div>
      <%}%>
    </div>
  </body>
</html>
